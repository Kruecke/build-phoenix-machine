#Generated by Kickstart Configurator
#platform=AMD64 or Intel EM64T

#System language
lang en_US
#Language modules to install
langsupport en_US
#System keyboard
keyboard us
#System mouse
mouse
#System timezone
timezone --utc Europe/Berlin
#Root password
rootpw --disabled
#Initial user
user phoenix --fullname "Phoenix" --password phoenix
#Reboot after installation
reboot
#Use text mode install
text
#Install OS instead of upgrade
install
#Use CDROM installation media
cdrom
#System bootloader configuration
bootloader --location=mbr 
#Clear the Master Boot Record
zerombr yes
#Partition clearing information
clearpart --all --initlabel 
#Disk partitioning information
part / --fstype ext4 --size 1 --grow 
part swap --recommended 
#System authorization infomation
auth  --useshadow  --enablemd5 
#Network information
network --bootproto=dhcp --device=eth0
#Firewall configuration
firewall --disabled 
#Do not configure the X Window System
skipx

%packages
@ ubuntu-server
wget
build-essential
git

%post
# Don't turn off the screen
echo "setterm -blank 0"                                                    > /etc/rc.local
echo "setterm -powerdown 0"                                               >> /etc/rc.local
echo "setterm -store"                                                     >> /etc/rc.local
# Move Phoenix setup to rc.local
echo "cd /root"                                                           >> /etc/rc.local
echo "git clone https://github.com/bird-house/malleefowl.git"             >> /etc/rc.local
echo "git clone https://github.com/bird-house/pyramid-phoenix.git"        >> /etc/rc.local
echo "make -C malleefowl"                                                 >> /etc/rc.local
echo "make -C pyramid-phoenix"                                            >> /etc/rc.local
echo "make -C pyramid-phoenix start"                                      >> /etc/rc.local
# Clean up rc.local after initial setup
echo "echo 'make -C /root/pyramid-phoenix start; exit 0' > /etc/rc.local" >> /etc/rc.local
echo "exit 0"                                                             >> /etc/rc.local
%end
